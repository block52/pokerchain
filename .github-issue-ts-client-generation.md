# TypeScript Client Generation Should Be Automated

## Problem

The `ts-client/` directory contains auto-generated TypeScript types from Protocol Buffer definitions, but currently developers must manually run `ignite generate ts-client` to generate these files.

**Current situation:**
- Generated files are NOT in `.gitignore`
- `config.yml` explicitly configures TypeScript client path: `client.typescript.path: ts-client`
- Generated package.json shows this is meant to be a publishable npm package: `block52-pokerchain-client-ts`
- Files include critical message type registries needed for CosmJS to encode custom poker module transactions

## Impact on Frontend Development

When frontend developers test SDK functions like `createGame()`, `joinGame()`, or `performAction()`, they encounter:

```
Error: Unregistered type url: /block52.pokerchain.poker.MsgCreateGame
```

This happens because CosmJS doesn't know how to encode custom poker module messages without the generated TypeScript registry from `ts-client/`.

**Frontend developers currently must:**
1. Install `ts-proto` globally: `npm install -g ts-proto`
2. Run `ignite generate ts-client` manually in the pokerchain directory
3. Wait for generation to complete (~30 seconds)
4. Import the generated registry into the SDK

## Questions for Backend Team

### 1. Should ts-client files be committed to Git?

**Option A: Commit generated files (recommended)**
- ✅ Frontend developers don't need Ignite CLI or Go toolchain
- ✅ Immediate availability after `git pull`
- ✅ Works with npm package publishing (package.json indicates this is meant to be published)
- ✅ Matches the fact that `config.yml` explicitly configures the path
- ❌ Diffs show generated code changes

**Option B: Gitignore and regenerate on-demand**
- ✅ Cleaner git history
- ✅ No generated code in version control
- ❌ Every developer must have Ignite CLI + ts-proto installed
- ❌ Must regenerate after every `git pull` that changes .proto files
- ❌ Breaks npm package publishing workflow

### 2. Should generation be automated?

**Option A: Generate during `ignite chain serve`**
- Add to chain startup scripts
- Ensures files are always up-to-date when chain is running

**Option B: Generate during proto changes**
- Add to `make proto-gen` target
- Keeps TypeScript types in sync with Go types

**Option C: Pre-commit hook**
- Automatically regenerate before commits that touch .proto files
- Ensures generated files stay in sync

**Option D: CI/CD automation**
- Generate on every PR
- Commit generated files automatically
- Ensures consistency across environments

## Recommended Solution

**Short-term (immediate fix):**
1. Add `ts-client/` to `.gitignore` if we don't want to commit generated files
2. Update `README.md` and `CLAUDE.md` to document the `ignite generate ts-client` requirement
3. Add to clean chain testing instructions

**Long-term (proper fix):**
1. Decide: commit generated files OR automate generation
2. If committing: Remove from .gitignore, commit current ts-client/
3. If automating: Add generation to appropriate build step (see options above)
4. Update SDK to import generated registry: `import { registry } from '@/path/to/ts-client/client'`

## Additional Context

**Files involved:**
- `/pokerchain/ts-client/` - Generated TypeScript client
- `/pokerchain/config.yml` - Ignite configuration (line 50-51: typescript.path)
- `/pokerchain/.gitignore` - Currently does NOT exclude ts-client/
- `/poker-vm/ui/src/sdk/signingClient.ts` - Needs to import generated registry

**Related errors:**
- `Unregistered type url: /block52.pokerchain.poker.MsgCreateGame`
- Rate limit errors from buf.build (fixed by installing ts-proto locally)
- TTY errors when Claude tries to run interactive commands

**Documentation to update:**
- `/pokerchain/README.md`
- `/pokerchain/CLAUDE.md`
- `/pokerchain/CLEAN_CHAIN_TEST.md`
- `/poker-vm/ui/TOMS_CHECKLIST.md`

## Priority

**High** - This blocks frontend developers from testing SDK functions for game creation, joining, and actions.

## Labels

- `backend`
- `infrastructure`
- `ignite`
- `typescript`
- `developer-experience`
